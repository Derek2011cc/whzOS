     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_init_gdtidt
     7 00000000                                 	EXTERN	_init_pic
     8 00000000                                 	EXTERN	_io_sti
     9 00000000                                 	EXTERN	_keyfifo
    10 00000000                                 	EXTERN	_fifo8_init
    11 00000000                                 	EXTERN	_mousefifo
    12 00000000                                 	EXTERN	_io_out8
    13 00000000                                 	EXTERN	_init_palette
    14 00000000                                 	EXTERN	_init_screen8
    15 00000000                                 	EXTERN	_init_mouse_cursor8
    16 00000000                                 	EXTERN	_boxfill8
    17 00000000                                 	EXTERN	_putfonts8_asc
    18 00000000                                 	EXTERN	_io_cli
    19 00000000                                 	EXTERN	_fifo8_status
    20 00000000                                 	EXTERN	_fifo8_get
    21 00000000                                 	EXTERN	_putblock8_8
    22 00000000                                 	EXTERN	_sprintf
    23 00000000                                 	EXTERN	_io_stihlt
    24 00000000                                 	EXTERN	_io_in8
    25 00000000                                 [FILE "bootpack.c"]
    26                                          [SECTION .data]
    27 00000000                                 LC0:
    28 00000000 68 65 6C 6C 6F 20 77 6F 72 6C   	DB	"hello world",0x00
       0000000A 64 00 
    29 0000000C                                 LC1:
    30 0000000C 77 68 7A 20 4F 53 00            	DB	"whz OS",0x00
    31 00000013                                 LC2:
    32 00000013 6C 6F 61 64 69 6E 67 2E 2E 2E   	DB	"loading....",0x00
       0000001D 2E 00 
    33 0000001F                                 LC3:
    34 0000001F 7C 00                           	DB	"|",0x00
    35 00000021                                 LC4:
    36 00000021 4F 4B 00                        	DB	"OK",0x00
    37 00000024                                 LC5:
    38 00000024 44 65 73 6B 74 6F 70 00         	DB	"Desktop",0x00
    39 0000002C                                 LC6:
    40 0000002C 31 2E 66 69 6C 65 00            	DB	"1.file",0x00
    41 00000033                                 LC7:
    42 00000033 32 2E 73 68 65 6C 6C 00         	DB	"2.shell",0x00
    43 0000003B                                 LC8:
    44 0000003B 33 2E 6F 66 66 00               	DB	"3.off",0x00
    45 00000041                                 LC10:
    46 00000041 4F 53 20 73 68 65 6C 6C 00      	DB	"OS shell",0x00
    47 0000004A                                 LC11:
    48 0000004A 3E 00                           	DB	">",0x00
    49 0000004C                                 LC9:
    50 0000004C 25 30 32 58 00                  	DB	"%02X",0x00
    51                                          [SECTION .text]
    52 00000000                                 	GLOBAL	_HariMain
    53 00000000                                 _HariMain:
    54 00000000 55                              	PUSH	EBP
    55 00000001 89 E5                           	MOV	EBP,ESP
    56 00000003 57                              	PUSH	EDI
    57 00000004 56                              	PUSH	ESI
    58 00000005 53                              	PUSH	EBX
    59 00000006 BB 00000002                     	MOV	EBX,2
    60 0000000B 81 EC 000001FC                  	SUB	ESP,508
    61 00000011 E8 [00000000]                   	CALL	_init_gdtidt
    62 00000016 E8 [00000000]                   	CALL	_init_pic
    63 0000001B E8 [00000000]                   	CALL	_io_sti
    64 00000020 8D 85 FFFFFEA4                  	LEA	EAX,DWORD [-348+EBP]
    65 00000026 50                              	PUSH	EAX
    66 00000027 6A 20                           	PUSH	32
    67 00000029 68 [00000000]                   	PUSH	_keyfifo
    68 0000002E E8 [00000000]                   	CALL	_fifo8_init
    69 00000033 8D 85 FFFFFE24                  	LEA	EAX,DWORD [-476+EBP]
    70 00000039 50                              	PUSH	EAX
    71 0000003A 68 00000080                     	PUSH	128
    72 0000003F 68 [00000000]                   	PUSH	_mousefifo
    73 00000044 E8 [00000000]                   	CALL	_fifo8_init
    74 00000049 68 000000F9                     	PUSH	249
    75 0000004E 6A 21                           	PUSH	33
    76 00000050 E8 [00000000]                   	CALL	_io_out8
    77 00000055 83 C4 20                        	ADD	ESP,32
    78 00000058 68 000000EF                     	PUSH	239
    79 0000005D 68 000000A1                     	PUSH	161
    80 00000062 E8 [00000000]                   	CALL	_io_out8
    81 00000067 E8 00000693                     	CALL	_init_keyboard
    82 0000006C E8 [00000000]                   	CALL	_init_palette
    83 00000071 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    84 00000078 50                              	PUSH	EAX
    85 00000079 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    86 00000080 50                              	PUSH	EAX
    87 00000081 FF 35 00000FF8                  	PUSH	DWORD [4088]
    88 00000087 E8 [00000000]                   	CALL	_init_screen8
    89 0000008C 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    90 00000093 8D 48 F0                        	LEA	ECX,DWORD [-16+EAX]
    91 00000096 89 C8                           	MOV	EAX,ECX
    92 00000098 99                              	CDQ
    93 00000099 F7 FB                           	IDIV	EBX
    94 0000009B 89 C7                           	MOV	EDI,EAX
    95 0000009D 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    96 000000A4 6A 0E                           	PUSH	14
    97 000000A6 8D 48 D4                        	LEA	ECX,DWORD [-44+EAX]
    98 000000A9 89 C8                           	MOV	EAX,ECX
    99 000000AB 99                              	CDQ
   100 000000AC F7 FB                           	IDIV	EBX
   101 000000AE 89 C6                           	MOV	ESI,EAX
   102 000000B0 31 DB                           	XOR	EBX,EBX
   103 000000B2 8D 85 FFFFFEC4                  	LEA	EAX,DWORD [-316+EBP]
   104 000000B8 50                              	PUSH	EAX
   105 000000B9 E8 [00000000]                   	CALL	_init_mouse_cursor8
   106 000000BE 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   107 000000C5 48                              	DEC	EAX
   108 000000C6 50                              	PUSH	EAX
   109 000000C7 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   110 000000CE 48                              	DEC	EAX
   111 000000CF 50                              	PUSH	EAX
   112 000000D0 6A 00                           	PUSH	0
   113 000000D2 6A 00                           	PUSH	0
   114 000000D4 6A 0E                           	PUSH	14
   115 000000D6 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   116 000000DD 50                              	PUSH	EAX
   117 000000DE FF 35 00000FF8                  	PUSH	DWORD [4088]
   118 000000E4 E8 [00000000]                   	CALL	_boxfill8
   119 000000E9 83 C4 38                        	ADD	ESP,56
   120 000000EC 68 [00000000]                   	PUSH	LC0
   121 000000F1 6A 0D                           	PUSH	13
   122 000000F3 6A 0F                           	PUSH	15
   123 000000F5 6A 78                           	PUSH	120
   124 000000F7 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   125 000000FE 50                              	PUSH	EAX
   126 000000FF FF 35 00000FF8                  	PUSH	DWORD [4088]
   127 00000105 E8 [00000000]                   	CALL	_putfonts8_asc
   128 0000010A 68 [0000000C]                   	PUSH	LC1
   129 0000010F 6A 00                           	PUSH	0
   130 00000111 6A 24                           	PUSH	36
   131 00000113 68 00000083                     	PUSH	131
   132 00000118 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   133 0000011F 50                              	PUSH	EAX
   134 00000120 FF 35 00000FF8                  	PUSH	DWORD [4088]
   135 00000126 E8 [00000000]                   	CALL	_putfonts8_asc
   136 0000012B 83 C4 30                        	ADD	ESP,48
   137 0000012E 68 [0000000C]                   	PUSH	LC1
   138 00000133 6A 07                           	PUSH	7
   139 00000135 6A 23                           	PUSH	35
   140 00000137 68 00000082                     	PUSH	130
   141 0000013C 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   142 00000143 50                              	PUSH	EAX
   143 00000144 FF 35 00000FF8                  	PUSH	DWORD [4088]
   144 0000014A E8 [00000000]                   	CALL	_putfonts8_asc
   145 0000014F 68 [00000013]                   	PUSH	LC2
   146 00000154 6A 07                           	PUSH	7
   147 00000156 6A 3C                           	PUSH	60
   148 00000158 6A 78                           	PUSH	120
   149 0000015A 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   150 00000161 50                              	PUSH	EAX
   151 00000162 FF 35 00000FF8                  	PUSH	DWORD [4088]
   152 00000168 E8 [00000000]                   	CALL	_putfonts8_asc
   153 0000016D 83 C4 30                        	ADD	ESP,48
   154 00000170                                 L7:
   155 00000170 89 D8                           	MOV	EAX,EBX
   156 00000172 B9 000186A0                     	MOV	ECX,100000
   157 00000177 99                              	CDQ
   158 00000178 F7 F9                           	IDIV	ECX
   159 0000017A 85 D2                           	TEST	EDX,EDX
   160 0000017C 75 26                           	JNE	L4
   161 0000017E 68 [0000001F]                   	PUSH	LC3
   162 00000183 8D 40 1E                        	LEA	EAX,DWORD [30+EAX]
   163 00000186 6A 00                           	PUSH	0
   164 00000188 68 00000087                     	PUSH	135
   165 0000018D 50                              	PUSH	EAX
   166 0000018E 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   167 00000195 50                              	PUSH	EAX
   168 00000196 FF 35 00000FF8                  	PUSH	DWORD [4088]
   169 0000019C E8 [00000000]                   	CALL	_putfonts8_asc
   170 000001A1 83 C4 18                        	ADD	ESP,24
   171 000001A4                                 L4:
   172 000001A4 43                              	INC	EBX
   173 000001A5 81 FB 017D783F                  	CMP	EBX,24999999
   174 000001AB 7E C3                           	JLE	L7
   175 000001AD 68 [00000021]                   	PUSH	LC4
   176 000001B2 BB 0EE6B27F                     	MOV	EBX,249999999
   177 000001B7 6A 07                           	PUSH	7
   178 000001B9 68 00000087                     	PUSH	135
   179 000001BE 68 00000127                     	PUSH	295
   180 000001C3 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   181 000001CA 50                              	PUSH	EAX
   182 000001CB FF 35 00000FF8                  	PUSH	DWORD [4088]
   183 000001D1 E8 [00000000]                   	CALL	_putfonts8_asc
   184 000001D6 83 C4 18                        	ADD	ESP,24
   185 000001D9                                 L12:
   186 000001D9 4B                              	DEC	EBX
   187 000001DA 79 FD                           	JNS	L12
   188 000001DC 68 [00000013]                   	PUSH	LC2
   189 000001E1 BB 0EE6B27F                     	MOV	EBX,249999999
   190 000001E6 6A 0E                           	PUSH	14
   191 000001E8 6A 3C                           	PUSH	60
   192 000001EA 6A 78                           	PUSH	120
   193 000001EC 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   194 000001F3 50                              	PUSH	EAX
   195 000001F4 FF 35 00000FF8                  	PUSH	DWORD [4088]
   196 000001FA E8 [00000000]                   	CALL	_putfonts8_asc
   197 000001FF 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   198 00000206 48                              	DEC	EAX
   199 00000207 50                              	PUSH	EAX
   200 00000208 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   201 0000020F 48                              	DEC	EAX
   202 00000210 50                              	PUSH	EAX
   203 00000211 6A 00                           	PUSH	0
   204 00000213 6A 00                           	PUSH	0
   205 00000215 6A 0E                           	PUSH	14
   206 00000217 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   207 0000021E 50                              	PUSH	EAX
   208 0000021F FF 35 00000FF8                  	PUSH	DWORD [4088]
   209 00000225 E8 [00000000]                   	CALL	_boxfill8
   210 0000022A 83 C4 34                        	ADD	ESP,52
   211 0000022D 68 [0000000C]                   	PUSH	LC1
   212 00000232 6A 00                           	PUSH	0
   213 00000234 6A 3C                           	PUSH	60
   214 00000236 68 00000083                     	PUSH	131
   215 0000023B 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   216 00000242 50                              	PUSH	EAX
   217 00000243 FF 35 00000FF8                  	PUSH	DWORD [4088]
   218 00000249 E8 [00000000]                   	CALL	_putfonts8_asc
   219 0000024E 68 [0000000C]                   	PUSH	LC1
   220 00000253 6A 07                           	PUSH	7
   221 00000255 6A 3C                           	PUSH	60
   222 00000257 68 00000082                     	PUSH	130
   223 0000025C 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   224 00000263 50                              	PUSH	EAX
   225 00000264 FF 35 00000FF8                  	PUSH	DWORD [4088]
   226 0000026A E8 [00000000]                   	CALL	_putfonts8_asc
   227 0000026F 83 C4 30                        	ADD	ESP,48
   228 00000272                                 L17:
   229 00000272 4B                              	DEC	EBX
   230 00000273 79 FD                           	JNS	L17
   231 00000275 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   232 0000027C 48                              	DEC	EAX
   233 0000027D 50                              	PUSH	EAX
   234 0000027E 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   235 00000285 48                              	DEC	EAX
   236 00000286 50                              	PUSH	EAX
   237 00000287 6A 00                           	PUSH	0
   238 00000289 6A 00                           	PUSH	0
   239 0000028B 6A 0E                           	PUSH	14
   240 0000028D 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   241 00000294 50                              	PUSH	EAX
   242 00000295 FF 35 00000FF8                  	PUSH	DWORD [4088]
   243 0000029B E8 [00000000]                   	CALL	_boxfill8
   244 000002A0 68 [0000000C]                   	PUSH	LC1
   245 000002A5 6A 00                           	PUSH	0
   246 000002A7 6A 0A                           	PUSH	10
   247 000002A9 68 00000083                     	PUSH	131
   248 000002AE 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   249 000002B5 50                              	PUSH	EAX
   250 000002B6 FF 35 00000FF8                  	PUSH	DWORD [4088]
   251 000002BC E8 [00000000]                   	CALL	_putfonts8_asc
   252 000002C1 83 C4 34                        	ADD	ESP,52
   253 000002C4 68 [0000000C]                   	PUSH	LC1
   254 000002C9 6A 07                           	PUSH	7
   255 000002CB 6A 0A                           	PUSH	10
   256 000002CD 68 00000082                     	PUSH	130
   257 000002D2 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   258 000002D9 50                              	PUSH	EAX
   259 000002DA FF 35 00000FF8                  	PUSH	DWORD [4088]
   260 000002E0 E8 [00000000]                   	CALL	_putfonts8_asc
   261 000002E5 68 [00000024]                   	PUSH	LC5
   262 000002EA 6A 06                           	PUSH	6
   263 000002EC 6A 19                           	PUSH	25
   264 000002EE 6A 7E                           	PUSH	126
   265 000002F0 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   266 000002F7 50                              	PUSH	EAX
   267 000002F8 FF 35 00000FF8                  	PUSH	DWORD [4088]
   268 000002FE E8 [00000000]                   	CALL	_putfonts8_asc
   269 00000303 83 C4 30                        	ADD	ESP,48
   270 00000306 68 [0000002C]                   	PUSH	LC6
   271 0000030B 6A 07                           	PUSH	7
   272 0000030D 6A 28                           	PUSH	40
   273 0000030F 6A 1E                           	PUSH	30
   274 00000311 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   275 00000318 50                              	PUSH	EAX
   276 00000319 FF 35 00000FF8                  	PUSH	DWORD [4088]
   277 0000031F E8 [00000000]                   	CALL	_putfonts8_asc
   278 00000324 68 [00000033]                   	PUSH	LC7
   279 00000329 6A 07                           	PUSH	7
   280 0000032B 6A 37                           	PUSH	55
   281 0000032D 6A 1E                           	PUSH	30
   282 0000032F 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   283 00000336 50                              	PUSH	EAX
   284 00000337 FF 35 00000FF8                  	PUSH	DWORD [4088]
   285 0000033D E8 [00000000]                   	CALL	_putfonts8_asc
   286 00000342 83 C4 30                        	ADD	ESP,48
   287 00000345 68 [0000003B]                   	PUSH	LC8
   288 0000034A 6A 07                           	PUSH	7
   289 0000034C 6A 46                           	PUSH	70
   290 0000034E 6A 1E                           	PUSH	30
   291 00000350 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   292 00000357 50                              	PUSH	EAX
   293 00000358 FF 35 00000FF8                  	PUSH	DWORD [4088]
   294 0000035E E8 [00000000]                   	CALL	_putfonts8_asc
   295 00000363 8D 85 FFFFFE14                  	LEA	EAX,DWORD [-492+EBP]
   296 00000369 50                              	PUSH	EAX
   297 0000036A E8 000003B1                     	CALL	_enable_mouse
   298 0000036F 83 C4 1C                        	ADD	ESP,28
   299 00000372 C7 85 FFFFFE08 00000000         	MOV	DWORD [-504+EBP],0
   300 0000037C C7 85 FFFFFE04 00000000         	MOV	DWORD [-508+EBP],0
   301 00000386 C7 85 FFFFFE00 00000000         	MOV	DWORD [-512+EBP],0
   302 00000390 C7 85 FFFFFDFC 00000000         	MOV	DWORD [-516+EBP],0
   303 0000039A C7 85 FFFFFDF8 00000000         	MOV	DWORD [-520+EBP],0
   304 000003A4                                 L18:
   305 000003A4 E8 [00000000]                   	CALL	_io_cli
   306 000003A9 68 [00000000]                   	PUSH	_keyfifo
   307 000003AE E8 [00000000]                   	CALL	_fifo8_status
   308 000003B3 68 [00000000]                   	PUSH	_mousefifo
   309 000003B8 89 C3                           	MOV	EBX,EAX
   310 000003BA E8 [00000000]                   	CALL	_fifo8_status
   311 000003BF 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   312 000003C2 5B                              	POP	EBX
   313 000003C3 5A                              	POP	EDX
   314 000003C4 85 C0                           	TEST	EAX,EAX
   315 000003C6 0F 84 00000317                  	JE	L50
   316 000003CC 68 [00000000]                   	PUSH	_keyfifo
   317 000003D1 E8 [00000000]                   	CALL	_fifo8_status
   318 000003D6 59                              	POP	ECX
   319 000003D7 85 C0                           	TEST	EAX,EAX
   320 000003D9 0F 85 000002DC                  	JNE	L51
   321 000003DF 68 [00000000]                   	PUSH	_mousefifo
   322 000003E4 E8 [00000000]                   	CALL	_fifo8_status
   323 000003E9 5A                              	POP	EDX
   324 000003EA 85 C0                           	TEST	EAX,EAX
   325 000003EC 74 B6                           	JE	L18
   326 000003EE 68 [00000000]                   	PUSH	_mousefifo
   327 000003F3 E8 [00000000]                   	CALL	_fifo8_get
   328 000003F8 89 C3                           	MOV	EBX,EAX
   329 000003FA E8 [00000000]                   	CALL	_io_sti
   330 000003FF 0F B6 C3                        	MOVZX	EAX,BL
   331 00000402 50                              	PUSH	EAX
   332 00000403 8D 85 FFFFFE14                  	LEA	EAX,DWORD [-492+EBP]
   333 00000409 50                              	PUSH	EAX
   334 0000040A E8 0000033F                     	CALL	_mouse_decode
   335 0000040F 83 C4 0C                        	ADD	ESP,12
   336 00000412 85 C0                           	TEST	EAX,EAX
   337 00000414 74 8E                           	JE	L18
   338 00000416 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   339 0000041D 48                              	DEC	EAX
   340 0000041E 50                              	PUSH	EAX
   341 0000041F 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   342 00000426 48                              	DEC	EAX
   343 00000427 50                              	PUSH	EAX
   344 00000428 6A 00                           	PUSH	0
   345 0000042A 6A 00                           	PUSH	0
   346 0000042C 6A 0E                           	PUSH	14
   347 0000042E 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   348 00000435 50                              	PUSH	EAX
   349 00000436 FF 35 00000FF8                  	PUSH	DWORD [4088]
   350 0000043C E8 [00000000]                   	CALL	_boxfill8
   351 00000441 68 [0000000C]                   	PUSH	LC1
   352 00000446 6A 00                           	PUSH	0
   353 00000448 6A 0A                           	PUSH	10
   354 0000044A 68 00000083                     	PUSH	131
   355 0000044F 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   356 00000456 50                              	PUSH	EAX
   357 00000457 FF 35 00000FF8                  	PUSH	DWORD [4088]
   358 0000045D E8 [00000000]                   	CALL	_putfonts8_asc
   359 00000462 83 C4 34                        	ADD	ESP,52
   360 00000465 68 [0000000C]                   	PUSH	LC1
   361 0000046A 6A 07                           	PUSH	7
   362 0000046C 6A 0A                           	PUSH	10
   363 0000046E 68 00000082                     	PUSH	130
   364 00000473 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   365 0000047A 50                              	PUSH	EAX
   366 0000047B FF 35 00000FF8                  	PUSH	DWORD [4088]
   367 00000481 E8 [00000000]                   	CALL	_putfonts8_asc
   368 00000486 68 [00000024]                   	PUSH	LC5
   369 0000048B 6A 06                           	PUSH	6
   370 0000048D 6A 19                           	PUSH	25
   371 0000048F 6A 7E                           	PUSH	126
   372 00000491 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   373 00000498 50                              	PUSH	EAX
   374 00000499 FF 35 00000FF8                  	PUSH	DWORD [4088]
   375 0000049F E8 [00000000]                   	CALL	_putfonts8_asc
   376 000004A4 83 C4 30                        	ADD	ESP,48
   377 000004A7 68 [0000002C]                   	PUSH	LC6
   378 000004AC 6A 07                           	PUSH	7
   379 000004AE 6A 28                           	PUSH	40
   380 000004B0 6A 1E                           	PUSH	30
   381 000004B2 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   382 000004B9 50                              	PUSH	EAX
   383 000004BA FF 35 00000FF8                  	PUSH	DWORD [4088]
   384 000004C0 E8 [00000000]                   	CALL	_putfonts8_asc
   385 000004C5 68 [00000033]                   	PUSH	LC7
   386 000004CA 6A 07                           	PUSH	7
   387 000004CC 6A 37                           	PUSH	55
   388 000004CE 6A 1E                           	PUSH	30
   389 000004D0 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   390 000004D7 50                              	PUSH	EAX
   391 000004D8 FF 35 00000FF8                  	PUSH	DWORD [4088]
   392 000004DE E8 [00000000]                   	CALL	_putfonts8_asc
   393 000004E3 83 C4 30                        	ADD	ESP,48
   394 000004E6 68 [0000003B]                   	PUSH	LC8
   395 000004EB 6A 07                           	PUSH	7
   396 000004ED 6A 46                           	PUSH	70
   397 000004EF 6A 1E                           	PUSH	30
   398 000004F1 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   399 000004F8 50                              	PUSH	EAX
   400 000004F9 FF 35 00000FF8                  	PUSH	DWORD [4088]
   401 000004FF E8 [00000000]                   	CALL	_putfonts8_asc
   402 00000504 83 C4 18                        	ADD	ESP,24
   403 00000507 8B 85 FFFFFE20                  	MOV	EAX,DWORD [-480+EBP]
   404 0000050D A9 00000001                     	TEST	EAX,1
   405 00000512 74 0E                           	JE	L27
   406 00000514 C6 45 C5 4C                     	MOV	BYTE [-59+EBP],76
   407 00000518 C7 85 FFFFFE08 00000000         	MOV	DWORD [-504+EBP],0
   408 00000522                                 L27:
   409 00000522 A9 00000002                     	TEST	EAX,2
   410 00000527 74 57                           	JE	L28
   411 00000529 8D 5F 64                        	LEA	EBX,DWORD [100+EDI]
   412 0000052C 8D 56 64                        	LEA	EDX,DWORD [100+ESI]
   413 0000052F C6 45 C7 52                     	MOV	BYTE [-57+EBP],82
   414 00000533 C7 85 FFFFFE08 00000001         	MOV	DWORD [-504+EBP],1
   415 0000053D 89 BD FFFFFE04                  	MOV	DWORD [-508+EBP],EDI
   416 00000543 89 B5 FFFFFE00                  	MOV	DWORD [-512+EBP],ESI
   417 00000549 89 9D FFFFFDFC                  	MOV	DWORD [-516+EBP],EBX
   418 0000054F 89 95 FFFFFDF8                  	MOV	DWORD [-520+EBP],EDX
   419 00000555 81 FF 000000DC                  	CMP	EDI,220
   420 0000055B 7E 0F                           	JLE	L29
   421 0000055D 8D 5F 9C                        	LEA	EBX,DWORD [-100+EDI]
   422 00000560 89 BD FFFFFDFC                  	MOV	DWORD [-516+EBP],EDI
   423 00000566 89 9D FFFFFE04                  	MOV	DWORD [-508+EBP],EBX
   424 0000056C                                 L29:
   425 0000056C 83 FE 64                        	CMP	ESI,100
   426 0000056F 7E 0F                           	JLE	L28
   427 00000571 8D 56 9C                        	LEA	EDX,DWORD [-100+ESI]
   428 00000574 89 B5 FFFFFDF8                  	MOV	DWORD [-520+EBP],ESI
   429 0000057A 89 95 FFFFFE00                  	MOV	DWORD [-512+EBP],EDX
   430 00000580                                 L28:
   431 00000580 83 E0 04                        	AND	EAX,4
   432 00000583 74 04                           	JE	L32
   433 00000585 C6 45 C6 43                     	MOV	BYTE [-58+EBP],67
   434 00000589                                 L32:
   435 00000589 03 B5 FFFFFE1C                  	ADD	ESI,DWORD [-484+EBP]
   436 0000058F 03 BD FFFFFE18                  	ADD	EDI,DWORD [-488+EBP]
   437 00000595 0F 88 00000119                  	JS	L52
   438 0000059B                                 L33:
   439 0000059B 85 F6                           	TEST	ESI,ESI
   440 0000059D 0F 88 0000010A                  	JS	L53
   441 000005A3                                 L34:
   442 000005A3 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   443 000005AA 83 E8 10                        	SUB	EAX,16
   444 000005AD 39 C7                           	CMP	EDI,EAX
   445 000005AF 7E 02                           	JLE	L35
   446 000005B1 89 C7                           	MOV	EDI,EAX
   447 000005B3                                 L35:
   448 000005B3 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   449 000005BA 83 E8 10                        	SUB	EAX,16
   450 000005BD 39 C6                           	CMP	ESI,EAX
   451 000005BF 7E 02                           	JLE	L36
   452 000005C1 89 C6                           	MOV	ESI,EAX
   453 000005C3                                 L36:
   454 000005C3 83 BD FFFFFE08 01               	CMP	DWORD [-504+EBP],1
   455 000005CA 0F 84 000000A8                  	JE	L54
   456 000005D0                                 L37:
   457 000005D0 80 7D C4 30                     	CMP	BYTE [-60+EBP],48
   458 000005D4 74 2A                           	JE	L55
   459 000005D6                                 L39:
   460 000005D6 6A 10                           	PUSH	16
   461 000005D8 8D 85 FFFFFEC4                  	LEA	EAX,DWORD [-316+EBP]
   462 000005DE 50                              	PUSH	EAX
   463 000005DF 56                              	PUSH	ESI
   464 000005E0 57                              	PUSH	EDI
   465 000005E1 6A 10                           	PUSH	16
   466 000005E3 6A 10                           	PUSH	16
   467 000005E5 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   468 000005EC 50                              	PUSH	EAX
   469 000005ED FF 35 00000FF8                  	PUSH	DWORD [4088]
   470 000005F3 E8 [00000000]                   	CALL	_putblock8_8
   471 000005F8 83 C4 20                        	ADD	ESP,32
   472 000005FB E9 FFFFFDA4                     	JMP	L18
   473 00000600                                 L55:
   474 00000600 80 7D C5 33                     	CMP	BYTE [-59+EBP],51
   475 00000604 75 D0                           	JNE	L39
   476 00000606                                 L43:
   477 00000606 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   478 0000060D 48                              	DEC	EAX
   479 0000060E 50                              	PUSH	EAX
   480 0000060F 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   481 00000616 48                              	DEC	EAX
   482 00000617 50                              	PUSH	EAX
   483 00000618 6A 00                           	PUSH	0
   484 0000061A 6A 00                           	PUSH	0
   485 0000061C 6A 0E                           	PUSH	14
   486 0000061E 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   487 00000625 50                              	PUSH	EAX
   488 00000626 FF 35 00000FF8                  	PUSH	DWORD [4088]
   489 0000062C E8 [00000000]                   	CALL	_boxfill8
   490 00000631 68 [00000041]                   	PUSH	LC10
   491 00000636 6A 00                           	PUSH	0
   492 00000638 6A 0A                           	PUSH	10
   493 0000063A 68 00000083                     	PUSH	131
   494 0000063F 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   495 00000646 50                              	PUSH	EAX
   496 00000647 FF 35 00000FF8                  	PUSH	DWORD [4088]
   497 0000064D E8 [00000000]                   	CALL	_putfonts8_asc
   498 00000652 83 C4 34                        	ADD	ESP,52
   499 00000655 68 [0000004A]                   	PUSH	LC11
   500 0000065A 6A 00                           	PUSH	0
   501 0000065C 6A 0A                           	PUSH	10
   502 0000065E 6A 0A                           	PUSH	10
   503 00000660 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   504 00000667 50                              	PUSH	EAX
   505 00000668 FF 35 00000FF8                  	PUSH	DWORD [4088]
   506 0000066E E8 [00000000]                   	CALL	_putfonts8_asc
   507 00000673 83 C4 18                        	ADD	ESP,24
   508 00000676 EB 8E                           	JMP	L43
   509 00000678                                 L54:
   510 00000678 FF B5 FFFFFDF8                  	PUSH	DWORD [-520+EBP]
   511 0000067E FF B5 FFFFFDFC                  	PUSH	DWORD [-516+EBP]
   512 00000684 FF B5 FFFFFE00                  	PUSH	DWORD [-512+EBP]
   513 0000068A FF B5 FFFFFE04                  	PUSH	DWORD [-508+EBP]
   514 00000690 6A 0F                           	PUSH	15
   515 00000692 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   516 00000699 50                              	PUSH	EAX
   517 0000069A FF 35 00000FF8                  	PUSH	DWORD [4088]
   518 000006A0 E8 [00000000]                   	CALL	_boxfill8
   519 000006A5 83 C4 1C                        	ADD	ESP,28
   520 000006A8 E9 FFFFFF23                     	JMP	L37
   521 000006AD                                 L53:
   522 000006AD 31 F6                           	XOR	ESI,ESI
   523 000006AF E9 FFFFFEEF                     	JMP	L34
   524 000006B4                                 L52:
   525 000006B4 31 FF                           	XOR	EDI,EDI
   526 000006B6 E9 FFFFFEE0                     	JMP	L33
   527 000006BB                                 L51:
   528 000006BB 68 [00000000]                   	PUSH	_keyfifo
   529 000006C0 E8 [00000000]                   	CALL	_fifo8_get
   530 000006C5 89 C3                           	MOV	EBX,EAX
   531 000006C7 E8 [00000000]                   	CALL	_io_sti
   532 000006CC 53                              	PUSH	EBX
   533 000006CD 8D 45 C4                        	LEA	EAX,DWORD [-60+EBP]
   534 000006D0 68 [0000004C]                   	PUSH	LC9
   535 000006D5 50                              	PUSH	EAX
   536 000006D6 E8 [00000000]                   	CALL	_sprintf
   537 000006DB 83 C4 10                        	ADD	ESP,16
   538 000006DE E9 FFFFFCC1                     	JMP	L18
   539 000006E3                                 L50:
   540 000006E3 E8 [00000000]                   	CALL	_io_stihlt
   541 000006E8 E9 FFFFFCB7                     	JMP	L18
   542 000006ED                                 	GLOBAL	_wait_KBC_sendready
   543 000006ED                                 _wait_KBC_sendready:
   544 000006ED 55                              	PUSH	EBP
   545 000006EE 89 E5                           	MOV	EBP,ESP
   546 000006F0                                 L57:
   547 000006F0 6A 64                           	PUSH	100
   548 000006F2 E8 [00000000]                   	CALL	_io_in8
   549 000006F7 59                              	POP	ECX
   550 000006F8 83 E0 02                        	AND	EAX,2
   551 000006FB 75 F3                           	JNE	L57
   552 000006FD C9                              	LEAVE
   553 000006FE C3                              	RET
   554 000006FF                                 	GLOBAL	_init_keyboard
   555 000006FF                                 _init_keyboard:
   556 000006FF 55                              	PUSH	EBP
   557 00000700 89 E5                           	MOV	EBP,ESP
   558 00000702 E8 FFFFFFE6                     	CALL	_wait_KBC_sendready
   559 00000707 6A 60                           	PUSH	96
   560 00000709 6A 64                           	PUSH	100
   561 0000070B E8 [00000000]                   	CALL	_io_out8
   562 00000710 E8 FFFFFFD8                     	CALL	_wait_KBC_sendready
   563 00000715 6A 47                           	PUSH	71
   564 00000717 6A 60                           	PUSH	96
   565 00000719 E8 [00000000]                   	CALL	_io_out8
   566 0000071E C9                              	LEAVE
   567 0000071F C3                              	RET
   568 00000720                                 	GLOBAL	_enable_mouse
   569 00000720                                 _enable_mouse:
   570 00000720 55                              	PUSH	EBP
   571 00000721 89 E5                           	MOV	EBP,ESP
   572 00000723 E8 FFFFFFC5                     	CALL	_wait_KBC_sendready
   573 00000728 68 000000D4                     	PUSH	212
   574 0000072D 6A 64                           	PUSH	100
   575 0000072F E8 [00000000]                   	CALL	_io_out8
   576 00000734 E8 FFFFFFB4                     	CALL	_wait_KBC_sendready
   577 00000739 68 000000F4                     	PUSH	244
   578 0000073E 6A 60                           	PUSH	96
   579 00000740 E8 [00000000]                   	CALL	_io_out8
   580 00000745 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   581 00000748 C6 40 03 00                     	MOV	BYTE [3+EAX],0
   582 0000074C C9                              	LEAVE
   583 0000074D C3                              	RET
   584 0000074E                                 	GLOBAL	_mouse_decode
   585 0000074E                                 _mouse_decode:
   586 0000074E 55                              	PUSH	EBP
   587 0000074F 89 E5                           	MOV	EBP,ESP
   588 00000751 56                              	PUSH	ESI
   589 00000752 53                              	PUSH	EBX
   590 00000753 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   591 00000756 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   592 00000759 89 CE                           	MOV	ESI,ECX
   593 0000075B 8A 42 03                        	MOV	AL,BYTE [3+EDX]
   594 0000075E 84 C0                           	TEST	AL,AL
   595 00000760 75 11                           	JNE	L64
   596 00000762 80 F9 FA                        	CMP	CL,-6
   597 00000765 74 06                           	JE	L73
   598 00000767                                 L72:
   599 00000767 31 C0                           	XOR	EAX,EAX
   600 00000769                                 L63:
   601 00000769 5B                              	POP	EBX
   602 0000076A 5E                              	POP	ESI
   603 0000076B 5D                              	POP	EBP
   604 0000076C C3                              	RET
   605 0000076D                                 L73:
   606 0000076D C6 42 03 01                     	MOV	BYTE [3+EDX],1
   607 00000771 EB F4                           	JMP	L72
   608 00000773                                 L64:
   609 00000773 3C 01                           	CMP	AL,1
   610 00000775 74 61                           	JE	L74
   611 00000777 3C 02                           	CMP	AL,2
   612 00000779 74 54                           	JE	L75
   613 0000077B 3C 03                           	CMP	AL,3
   614 0000077D 74 05                           	JE	L76
   615 0000077F 83 C8 FF                        	OR	EAX,-1
   616 00000782 EB E5                           	JMP	L63
   617 00000784                                 L76:
   618 00000784 8A 1A                           	MOV	BL,BYTE [EDX]
   619 00000786 81 E6 000000FF                  	AND	ESI,255
   620 0000078C 89 D8                           	MOV	EAX,EBX
   621 0000078E 88 4A 02                        	MOV	BYTE [2+EDX],CL
   622 00000791 83 E0 07                        	AND	EAX,7
   623 00000794 89 72 08                        	MOV	DWORD [8+EDX],ESI
   624 00000797 89 42 0C                        	MOV	DWORD [12+EDX],EAX
   625 0000079A 88 D8                           	MOV	AL,BL
   626 0000079C 0F B6 4A 01                     	MOVZX	ECX,BYTE [1+EDX]
   627 000007A0 83 E0 10                        	AND	EAX,16
   628 000007A3 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   629 000007A6 C6 42 03 01                     	MOV	BYTE [3+EDX],1
   630 000007AA 84 C0                           	TEST	AL,AL
   631 000007AC 74 09                           	JE	L70
   632 000007AE 81 C9 FFFFFF00                  	OR	ECX,-256
   633 000007B4 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   634 000007B7                                 L70:
   635 000007B7 83 E3 20                        	AND	EBX,32
   636 000007BA 84 DB                           	TEST	BL,BL
   637 000007BC 74 07                           	JE	L71
   638 000007BE 81 4A 08 FFFFFF00               	OR	DWORD [8+EDX],-256
   639 000007C5                                 L71:
   640 000007C5 F7 5A 08                        	NEG	DWORD [8+EDX]
   641 000007C8 B8 00000001                     	MOV	EAX,1
   642 000007CD EB 9A                           	JMP	L63
   643 000007CF                                 L75:
   644 000007CF 88 4A 01                        	MOV	BYTE [1+EDX],CL
   645 000007D2 C6 42 03 03                     	MOV	BYTE [3+EDX],3
   646 000007D6 EB 8F                           	JMP	L72
   647 000007D8                                 L74:
   648 000007D8 83 E6 C8                        	AND	ESI,-56
   649 000007DB 89 F0                           	MOV	EAX,ESI
   650 000007DD 3C 08                           	CMP	AL,8
   651 000007DF 75 86                           	JNE	L72
   652 000007E1 88 0A                           	MOV	BYTE [EDX],CL
   653 000007E3 C6 42 03 02                     	MOV	BYTE [3+EDX],2
   654 000007E7 E9 FFFFFF7B                     	JMP	L72
